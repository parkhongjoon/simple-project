<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE  mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="member">

<!-- 회원가입 -->
<insert id="insert" parameterType="hashMap" useGeneratedKeys="true" keyProperty="id">  
    <![CDATA[
    insert into member
    (name, nickname, userid, password, usermail, tel, zipcode, addr1, addr2, birth ) 
    values
    (#{name}, #{nickname}, #{userid}, #{password}, #{usermail}, #{tel}, #{zipcode}, #{addr1}, #{addr2}, #{birth} )
    ]]>
</insert>

<!-- 회원정보 -->
<select id="select_detail" parameterType="hashMap" resultType="hashMap">
    <![CDATA[
        select
        name,
        nickname,
        userid,
        password,
        usermail,
        tel,
        zipcode,
        addr1,
        addr2,
        birth
        from
        member
        where
        userid = #{userid}   
    ]]>
</select>

<!-- 업데이트 -->
<update id="update" parameterType="hashMap">  
   <![CDATA[  
   update member set  
   nickname = #{nickname},  
   password = #{password},  
   usermail = #{usermail},  
   tel = #{tel},
   zipcode = #{zipcode},  
   addr1 = #{addr1},  
   addr2 = #{addr2}
   where  
   userid = #{userid}  
   ]]>  
</update>  

<!-- 삭제 -->
<delete id="delete" parameterType="hashMap">  
   <![CDATA[  
   delete from member  
   where  
   userid = #{userid}  
   ]]>  
</delete>  

<select id="select_list" parameterType="hashMap" resultType="hashMap">  
   <![CDATA[  
   select
      *
   from  
   member 
   where userid = #{userid}  
   ]]>  
   <if test="keyword != null and keyword != ''">  
   and (userid like CONCAT('%',#{keyword},'%') or nickname like CONCAT('%',#{keyword},'%'))  
   </if>  
   order by name desc  
</select>

<!-- 로그인 -->
<select id="login" parameterType="hashMap" resultType="int">
    <![CDATA[
    select count(*) from member where userid=#{userid} and password=#{password}
    ]]>
</select>

<!-- 아이디 중복 체크 -->
<select id="idCheck" parameterType="hashMap" resultType="int">
   <![CDATA[
   select count(*) from member where userid=#{userid}
   ]]>
</select>

<!-- 닉네임 중복 체크 -->
<select id="nickCheck" parameterType="hashMap" resultType="int">
   <![CDATA[
   select count(*) from member where nickname=#{nickname}
   ]]>
</select>


<insert id="favorties" parameterType="hashMap" useGeneratedKeys="true" keyProperty="id">  
    <![CDATA[
    insert into favorites
    (userid, rtname, rtcode, rtaddr) 
    values
    (#{userid}, #{rtname}, #{rtcode}, #{rtaddr})
    ]]>
</insert>

</mapper>
